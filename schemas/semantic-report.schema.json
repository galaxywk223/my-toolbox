{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://my-toolbox.local/schemas/semantic-report.schema.json",
  "title": "SemanticReport",
  "type": "object",
  "additionalProperties": false,
  "required": ["scanTimestamp", "repoRoot", "modules", "summary", "ignoredFiles"],
  "properties": {
    "scanTimestamp": {
      "type": "string",
      "format": "date-time"
    },
    "repoRoot": {
      "type": "string",
      "minLength": 1
    },
    "modules": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/$defs/ModuleReport" }
    },
    "summary": { "$ref": "#/$defs/SemanticSummary" },
    "ignoredFiles": {
      "type": "array",
      "items": { "$ref": "#/$defs/IgnoredFile" }
    }
  },
  "$defs": {
    "LanguageStat": {
      "type": "object",
      "additionalProperties": false,
      "required": ["language", "bytes", "files", "percent"],
      "properties": {
        "language": { "type": "string", "minLength": 1 },
        "bytes": { "type": "integer", "minimum": 0 },
        "files": { "type": "integer", "minimum": 0 },
        "percent": { "type": "number", "minimum": 0, "maximum": 100 }
      }
    },
    "BackendStack": {
      "type": "object",
      "additionalProperties": false,
      "required": ["framework", "rest", "db", "queue", "orm", "migrations", "aiFeatures"],
      "properties": {
        "framework": { "type": "string", "minLength": 1 },
        "rest": { "type": "boolean" },
        "db": { "type": "string" },
        "queue": { "type": "string" },
        "orm": { "type": ["string", "null"] },
        "migrations": { "type": ["string", "null"] },
        "aiFeatures": { "type": "array", "items": { "type": "string" } }
      }
    },
    "FrontendStack": {
      "type": "object",
      "additionalProperties": false,
      "required": ["builder", "vue", "store", "ui", "visualization"],
      "properties": {
        "builder": { "type": "string", "minLength": 1 },
        "vue": { "type": ["integer", "null"], "minimum": 0, "maximum": 255 },
        "store": { "type": "string" },
        "ui": { "type": "string" },
        "visualization": { "type": "array", "items": { "type": "string" } }
      }
    },
    "GeneratedSummary": {
      "type": "object",
      "additionalProperties": false,
      "required": ["files", "klocIgnored"],
      "properties": {
        "files": { "type": "integer", "minimum": 0 },
        "klocIgnored": { "type": "number", "minimum": 0 }
      }
    },
    "AssetSummary": {
      "type": "object",
      "additionalProperties": false,
      "required": ["files", "bytes"],
      "properties": {
        "files": { "type": "integer", "minimum": 0 },
        "bytes": { "type": "integer", "minimum": 0 }
      }
    },
    "IgnoredFile": {
      "type": "object",
      "additionalProperties": false,
      "required": ["path", "size", "reason", "category"],
      "properties": {
        "path": { "type": "string", "minLength": 1 },
        "size": { "type": "integer", "minimum": 0 },
        "reason": { "type": "string", "minLength": 1 },
        "category": { "type": "string", "minLength": 1 }
      }
    },
    "ModuleReport": {
      "type": "object",
      "additionalProperties": false,
      "required": ["name", "path", "languages", "frameworks", "deps", "backend", "frontend", "generated", "assets", "warnings"],
      "properties": {
        "name": { "type": "string", "minLength": 1 },
        "path": { "type": "string", "minLength": 1 },
        "languages": { "type": "array", "items": { "$ref": "#/$defs/LanguageStat" } },
        "frameworks": { "type": "array", "items": { "type": "string" } },
        "deps": { "type": "array", "items": { "type": "string" } },
        "backend": { "anyOf": [{ "$ref": "#/$defs/BackendStack" }, { "type": "null" }] },
        "frontend": { "anyOf": [{ "$ref": "#/$defs/FrontendStack" }, { "type": "null" }] },
        "generated": { "anyOf": [{ "$ref": "#/$defs/GeneratedSummary" }, { "type": "null" }] },
        "assets": { "anyOf": [{ "$ref": "#/$defs/AssetSummary" }, { "type": "null" }] },
        "warnings": { "type": "array", "items": { "type": "string" } }
      }
    },
    "SemanticSummary": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "totalSize",
        "ignoredSize",
        "ignoredRatio",
        "assetsSize",
        "generatedFiles",
        "generatedKlocIgnored",
        "effectiveFiles",
        "effectiveKloc",
        "warnings"
      ],
      "properties": {
        "totalSize": { "type": "integer", "minimum": 0 },
        "ignoredSize": { "type": "integer", "minimum": 0 },
        "ignoredRatio": { "type": "number", "minimum": 0, "maximum": 1 },
        "assetsSize": { "type": "integer", "minimum": 0 },
        "generatedFiles": { "type": "integer", "minimum": 0 },
        "generatedKlocIgnored": { "type": "number", "minimum": 0 },
        "effectiveFiles": { "type": "integer", "minimum": 0 },
        "effectiveKloc": { "type": "number", "minimum": 0 },
        "warnings": { "type": "array", "items": { "type": "string" } }
      }
    }
  }
}
